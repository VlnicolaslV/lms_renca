{"ast":null,"code":"import axios from'axios';const API_URL='http://localhost:8000/api/usuario/';const login=async(rut,password)=>{try{const response=await axios.post(API_URL+'token/',{rut,password});// Verifica y guarda los tokens\nif(response.data.access&&response.data.refresh){console.log(\"Tokens recibidos:\",response.data);localStorage.setItem('token',response.data.access);document.cookie=`refresh=${response.data.refresh}; path=/; SameSite=Lax; Secure`;// Verificar las cookies después de guardarlas\nconsole.log(\"Cookies después de login:\",document.cookie);}else{console.error(\"Falta el token de acceso o de actualización.\");}return response.data;}catch(error){console.error(\"Error al iniciar sesión:\",error);throw error;}};const getUserData=async()=>{try{const token=localStorage.getItem('token');if(!token){throw new Error('No se ha encontrado un token de acceso');}const response=await axios.get(API_URL+'profile/',{headers:{'Authorization':`Bearer ${token}`}});return response.data;}catch(error){console.error(\"Error al obtener los datos del usuario:\",error);throw error;}};const cerrarSesion=()=>{localStorage.removeItem('token');document.cookie='refresh=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC; SameSite=Lax; Secure';};const authService={login,getUserData,cerrarSesion};export default authService;","map":{"version":3,"names":["axios","API_URL","login","rut","password","response","post","data","access","refresh","console","log","localStorage","setItem","document","cookie","error","getUserData","token","getItem","Error","get","headers","cerrarSesion","removeItem","authService"],"sources":["C:/Users/aggro/OneDrive/Desktop/Nueva carpeta (3)/LMS/lms_renca_frontend/src/services/authService.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_URL = 'http://localhost:8000/api/usuario/';\r\n\r\nconst login = async (rut, password) => {\r\n  try {\r\n    const response = await axios.post(API_URL + 'token/', {\r\n      rut,\r\n      password,\r\n    });\r\n\r\n    // Verifica y guarda los tokens\r\n    if (response.data.access && response.data.refresh) {\r\n      console.log(\"Tokens recibidos:\", response.data);\r\n      localStorage.setItem('token', response.data.access);\r\n      document.cookie = `refresh=${response.data.refresh}; path=/; SameSite=Lax; Secure`;\r\n\r\n      // Verificar las cookies después de guardarlas\r\n      console.log(\"Cookies después de login:\", document.cookie);\r\n    } else {\r\n      console.error(\"Falta el token de acceso o de actualización.\");\r\n    }\r\n\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Error al iniciar sesión:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nconst getUserData = async () => {\r\n  try {\r\n    const token = localStorage.getItem('token');\r\n    \r\n    if (!token) {\r\n      throw new Error('No se ha encontrado un token de acceso');\r\n    }\r\n    \r\n    const response = await axios.get(API_URL + 'profile/', {\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`\r\n      }\r\n    });\r\n    \r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Error al obtener los datos del usuario:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nconst cerrarSesion = () => {\r\n  localStorage.removeItem('token');\r\n  document.cookie = 'refresh=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC; SameSite=Lax; Secure';\r\n}\r\n\r\n\r\nconst authService = {\r\n  login,\r\n  getUserData,\r\n  cerrarSesion,\r\n};\r\n\r\nexport default authService;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CAEzB,KAAM,CAAAC,OAAO,CAAG,oCAAoC,CAEpD,KAAM,CAAAC,KAAK,CAAG,KAAAA,CAAOC,GAAG,CAAEC,QAAQ,GAAK,CACrC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAL,KAAK,CAACM,IAAI,CAACL,OAAO,CAAG,QAAQ,CAAE,CACpDE,GAAG,CACHC,QACF,CAAC,CAAC,CAEF;AACA,GAAIC,QAAQ,CAACE,IAAI,CAACC,MAAM,EAAIH,QAAQ,CAACE,IAAI,CAACE,OAAO,CAAE,CACjDC,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAEN,QAAQ,CAACE,IAAI,CAAC,CAC/CK,YAAY,CAACC,OAAO,CAAC,OAAO,CAAER,QAAQ,CAACE,IAAI,CAACC,MAAM,CAAC,CACnDM,QAAQ,CAACC,MAAM,CAAG,WAAWV,QAAQ,CAACE,IAAI,CAACE,OAAO,gCAAgC,CAElF;AACAC,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAEG,QAAQ,CAACC,MAAM,CAAC,CAC3D,CAAC,IAAM,CACLL,OAAO,CAACM,KAAK,CAAC,8CAA8C,CAAC,CAC/D,CAEA,MAAO,CAAAX,QAAQ,CAACE,IAAI,CACtB,CAAE,MAAOS,KAAK,CAAE,CACdN,OAAO,CAACM,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAChD,KAAM,CAAAA,KAAK,CACb,CACF,CAAC,CAED,KAAM,CAAAC,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC9B,GAAI,CACF,KAAM,CAAAC,KAAK,CAAGN,YAAY,CAACO,OAAO,CAAC,OAAO,CAAC,CAE3C,GAAI,CAACD,KAAK,CAAE,CACV,KAAM,IAAI,CAAAE,KAAK,CAAC,wCAAwC,CAAC,CAC3D,CAEA,KAAM,CAAAf,QAAQ,CAAG,KAAM,CAAAL,KAAK,CAACqB,GAAG,CAACpB,OAAO,CAAG,UAAU,CAAE,CACrDqB,OAAO,CAAE,CACP,eAAe,CAAE,UAAUJ,KAAK,EAClC,CACF,CAAC,CAAC,CAEF,MAAO,CAAAb,QAAQ,CAACE,IAAI,CACtB,CAAE,MAAOS,KAAK,CAAE,CACdN,OAAO,CAACM,KAAK,CAAC,yCAAyC,CAAEA,KAAK,CAAC,CAC/D,KAAM,CAAAA,KAAK,CACb,CACF,CAAC,CAED,KAAM,CAAAO,YAAY,CAAGA,CAAA,GAAM,CACzBX,YAAY,CAACY,UAAU,CAAC,OAAO,CAAC,CAChCV,QAAQ,CAACC,MAAM,CAAG,+EAA+E,CACnG,CAAC,CAGD,KAAM,CAAAU,WAAW,CAAG,CAClBvB,KAAK,CACLe,WAAW,CACXM,YACF,CAAC,CAED,cAAe,CAAAE,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}